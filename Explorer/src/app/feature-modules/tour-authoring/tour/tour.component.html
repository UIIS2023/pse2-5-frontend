<div class="tour">
  <p>Tours</p>
  <hr>
  <button class="overall-stats-button" [routerLink]="['overall-tour-statistics']" mat-raised-button>Overall Tour Statistics</button>
  <div class="card-container">
    <mat-card *ngFor="let t of tours" class="tour-card">
      <div (click)="openTourView(t.id!)" class="card-image" style="background-image: url('https://www.flimslaax.com/fileadmin/Daten/0Flims_Laax_Bilder/3-Outdoor/3-2-Wandern/3-2-1-Wanderwege/flims_laax_falera_wanderwege2.jpg');">
        <mat-card-title class="card-title">
          <p>{{t.name}}</p>

          <div class="price-wrapper">
            <p [ngClass]="{'discounted-price': showDiscount && selectedTour === t}">{{t.price}}RSD</p>    
            <p class="new-price" *ngIf="dialogOpen && showDiscount && selectedTour === t" style="color: red;"> -{{ discountPercentage }}% </p>
            <button class="discount-btn" (click)="openDiscountSaleForm($event, t)">Discount</button>
          </div>

        </mat-card-title>
        <p>{{tourStatus[t.status]}}</p>
        <p class="card-description">{{t.description}}</p>
      </div>
      <br>
      <mat-card-content class="card-content">
        <div class="circles-container">
          <p>Difficulty</p>
          <mat-icon [ngClass]="{'filled-circle': t.difficulty === 0, 'empty-circle': t.difficulty !== 0}">fiber_manual_record</mat-icon>
          <mat-icon [ngClass]="{'filled-circle': t.difficulty === 1, 'empty-circle': t.difficulty !== 1}">fiber_manual_record</mat-icon>
          <mat-icon [ngClass]="{'filled-circle': t.difficulty === 2, 'empty-circle': t.difficulty !== 2}">fiber_manual_record</mat-icon>
          <mat-icon [ngClass]="{'filled-circle': t.difficulty === 3, 'empty-circle': t.difficulty !== tourDifficulty.Pro}">fiber_manual_record</mat-icon>
        </div>
        <div>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>
                Equipment
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div>
              <xp-equipment-selection [tour]="t"></xp-equipment-selection>
            </div>
          </mat-expansion-panel>
        </div>
        <br>
        <div>
          <p>{{t.tags}}</p>
          <button type="submit" *ngIf="canBeArchived(t)" (click)="archiveTour(t)" mat-raised-button>Archive</button>
          <button type="submit" *ngIf="canBePublished(t)" (click)="publishTour(t)" mat-raised-button>Publish</button>
          <button disabled *ngIf="errorMessage" type="submit" mat-raised-button>Publish</button>
          <button type="submit" mat-raised-button (click)="showStatistics(t.id!)">Show statistics</button>
          <p *ngIf="errorMessage" class="error-message"> Can't publish with invalid data! </p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
<div class="bottom-right-button-container">

<button class="bottom-right-button" mat-icon-button (click)="openAddTourForm()">
  <mat-icon>add</mat-icon>
</button>
<button class="bottom-left-button" mat-icon-button (click)="openAddPublicKeyPoint()">
  <mat-icon>add_location</mat-icon>
</button>
<button class="bottom-left-button-2" mat-icon-button (click)="openAddPublicFacilitiy()">
  <mat-icon>map</mat-icon>
</button>
</div>
